# TomatoBot ‚Äî Telegram Pomodoro Bot

## –û–ø–∏—Å–∞–Ω–∏–µ
–ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π Telegram-–±–æ—Ç –¥–ª—è –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –ø–æ Pomodoro —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π –ø—Ä–æ–µ–∫—Ç–æ–≤, –∑–∞–¥–∞—á, –≥–µ–π–º–∏—Ñ–∏–∫–∞—Ü–∏–∏, –≥—Ä—É–ø–ø, –∫–∞—Å—Ç–æ–º–∏–∑–∞—Ü–∏–∏ –∏ –∞–Ω–∞–ª–∏—Ç–∏–∫–∏.

---

## üìÅ –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```
/2 TomatoBot
‚îú‚îÄ‚îÄ bot.py
‚îú‚îÄ‚îÄ config.py
‚îú‚îÄ‚îÄ requirements.txt
‚îú‚îÄ‚îÄ Dockerfile
‚îú‚îÄ‚îÄ README.md
‚îú‚îÄ‚îÄ WHAT_WAS_DONE.txt
‚îú‚îÄ‚îÄ db
‚îÇ   ‚îú‚îÄ‚îÄ models.py
‚îÇ   ‚îî‚îÄ‚îÄ session.py
‚îú‚îÄ‚îÄ handlers
‚îÇ   ‚îú‚îÄ‚îÄ gamification.py
‚îÇ   ‚îú‚îÄ‚îÄ guide.py
‚îÇ   ‚îú‚îÄ‚îÄ groups.py
‚îÇ   ‚îú‚îÄ‚îÄ pomodoro.py
‚îÇ   ‚îú‚îÄ‚îÄ projects.py
‚îÇ   ‚îú‚îÄ‚îÄ settings.py
‚îÇ   ‚îú‚îÄ‚îÄ tasks.py
‚îÇ   ‚îî‚îÄ‚îÄ tests
‚îÇ       ‚îú‚îÄ‚îÄ test_parallel_users.py
‚îÇ       ‚îú‚îÄ‚îÄ test_tasks.py
‚îÇ       ‚îî‚îÄ‚îÄ test_timer.py
‚îú‚îÄ‚îÄ pomodoro_bot
‚îÇ   ‚îî‚îÄ‚îÄ handlers
‚îÇ       ‚îî‚îÄ‚îÄ tests
‚îÇ           ‚îî‚îÄ‚îÄ test_timer.py
‚îú‚îÄ‚îÄ services
‚îÇ   ‚îú‚îÄ‚îÄ audio.py
‚îÇ   ‚îú‚îÄ‚îÄ forest.py
‚îÇ   ‚îú‚îÄ‚îÄ reminders.py
‚îÇ   ‚îú‚îÄ‚îÄ scheduler.py
‚îÇ   ‚îú‚îÄ‚îÄ theme.py
‚îÇ   ‚îî‚îÄ‚îÄ timer.py
‚îú‚îÄ‚îÄ static
‚îÇ   ‚îî‚îÄ‚îÄ themes
‚îÇ       ‚îú‚îÄ‚îÄ dark.json
‚îÇ       ‚îú‚îÄ‚îÄ forest.json
‚îÇ       ‚îî‚îÄ‚îÄ light.json
‚îú‚îÄ‚îÄ utils
‚îÇ   ‚îú‚îÄ‚îÄ helpers.py
‚îÇ   ‚îî‚îÄ‚îÄ scheduler.py
‚îî‚îÄ‚îÄ .vscode
    ‚îî‚îÄ‚îÄ settings.json
```


```
/2 TomatoBot
‚îú‚îÄ‚îÄ bot.py
‚îú‚îÄ‚îÄ config.py
‚îú‚îÄ‚îÄ requirements.txt
‚îú‚îÄ‚îÄ Dockerfile
‚îú‚îÄ‚îÄ README.md
‚îú‚îÄ‚îÄ WHAT_WAS_DONE.txt
‚îú‚îÄ‚îÄ db
‚îÇ   ‚îú‚îÄ‚îÄ models.py
‚îÇ   ‚îî‚îÄ‚îÄ session.py
‚îú‚îÄ‚îÄ handlers
‚îÇ   ‚îú‚îÄ‚îÄ gamification.py
‚îÇ   ‚îú‚îÄ‚îÄ guide.py
‚îÇ   ‚îú‚îÄ‚îÄ groups.py
‚îÇ   ‚îú‚îÄ‚îÄ pomodoro.py
‚îÇ   ‚îú‚îÄ‚îÄ projects.py
‚îÇ   ‚îú‚îÄ‚îÄ settings.py
‚îÇ   ‚îú‚îÄ‚îÄ tasks.py
‚îÇ   ‚îî‚îÄ‚îÄ tests
‚îÇ       ‚îú‚îÄ‚îÄ test_parallel_users.py
‚îÇ       ‚îú‚îÄ‚îÄ test_tasks.py
‚îÇ       ‚îî‚îÄ‚îÄ test_timer.py
‚îú‚îÄ‚îÄ pomodoro_bot
‚îÇ   ‚îî‚îÄ‚îÄ handlers
‚îÇ       ‚îî‚îÄ‚îÄ tests
‚îÇ           ‚îî‚îÄ‚îÄ test_timer.py
‚îú‚îÄ‚îÄ services
‚îÇ   ‚îú‚îÄ‚îÄ audio.py
‚îÇ   ‚îú‚îÄ‚îÄ forest.py
‚îÇ   ‚îú‚îÄ‚îÄ reminders.py
‚îÇ   ‚îú‚îÄ‚îÄ scheduler.py
‚îÇ   ‚îú‚îÄ‚îÄ theme.py
‚îÇ   ‚îî‚îÄ‚îÄ timer.py
‚îú‚îÄ‚îÄ static
‚îÇ   ‚îî‚îÄ‚îÄ themes
‚îÇ       ‚îú‚îÄ‚îÄ dark.json
‚îÇ       ‚îú‚îÄ‚îÄ forest.json
‚îÇ       ‚îî‚îÄ‚îÄ light.json
‚îú‚îÄ‚îÄ utils
‚îÇ   ‚îú‚îÄ‚îÄ helpers.py
‚îÇ   ‚îî‚îÄ‚îÄ scheduler.py
‚îî‚îÄ‚îÄ .vscode
    ‚îî‚îÄ‚îÄ settings.json
```

- **handlers/** ‚Äî –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∫–æ–º–∞–Ω–¥ Telegram
- **services/** ‚Äî –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ (—Ç–∞–π–º–µ—Ä, –ª–µ—Å, —Ç–µ–º—ã, –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è)
- **db/** ‚Äî –º–æ–¥–µ–ª–∏ –∏ —Å–µ—Å—Å–∏–∏ SQLAlchemy
- **utils/** ‚Äî –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –∏ –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫
- **static/** ‚Äî —Ç–µ–º—ã –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è

---

## üîß –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏
- **–Ø–∑—ã–∫:** Python 3.11+
- **–§—Ä–µ–π–º–≤–æ—Ä–∫:** python-telegram-bot[asyncio] >= 20.0
- **ORM:** SQLAlchemy >= 2.0 (async)
- **–ë–î:** SQLite (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é, —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è PostgreSQL –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞)
- **–¢–µ—Å—Ç—ã:** pytest
- **Docker:** –µ—Å—Ç—å Dockerfile
- **CI/CD:** –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç
- **–õ–∏–Ω—Ç–µ—Ä—ã:** –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç
- **.env:** —á–µ—Ä–µ–∑ python-dotenv
- **–ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ—Å—Ç—å:** –¥–∞ (async/await)
- **–ü–∞—Ä–∞–¥–∏–≥–º—ã:** –º–æ–Ω–æ–ª–∏—Ç, REST-like –∫–æ–º–∞–Ω–¥—ã, —Å–µ—Ä–≤–∏—Å–Ω—ã–π —Å–ª–æ–π

---

## –ü—Ä–æ–±–ª–µ–º—ã –∏ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π –¥–æ–ª–≥
- –ù–µ—Ç –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫ (try/except, fallback)
- –ù–µ—Ç –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ –≤–≤–æ–¥–∞ (SQL-–∏–Ω—ä–µ–∫—Ü–∏–∏, XSS –º–∞–ª–æ–≤–µ—Ä–æ—è—Ç–Ω—ã, –Ω–æ –≤–æ–∑–º–æ–∂–Ω—ã –æ—à–∏–±–∫–∏)
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è SQLite, –Ω–µ—Ç –º–∏–≥—Ä–∞—Ü–∏–π (Alembic)
- –ù–µ—Ç –∞–Ω–Ω–æ—Ç–∞—Ü–∏–π —Ç–∏–ø–æ–≤, —Å–ª–∞–±–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- –ù–µ—Ç DI-–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞, –Ω–µ—Ç –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤ CQRS/DDD
- –ù–µ—Ç CI/CD, –Ω–µ—Ç –ª–∏–Ω—Ç–µ—Ä–æ–≤, –ø–æ–∫—Ä—ã—Ç–∏–µ —Ç–µ—Å—Ç–∞–º–∏ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ
- –ù–µ—Ç graceful shutdown, retry-–º–µ—Ö–∞–Ω–∏–∑–º–æ–≤

**–ü—Ä–æ–±–ª–µ–º–Ω—ã–µ –º–µ—Å—Ç–∞:**
- `handlers/tasks.py`: –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –∏ try/except –ø—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å –ë–î
- `services/timer.py`: –Ω–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ/–ø–∞—É–∑–µ —Ç–∞–π–º–µ—Ä–∞
- `db/models.py`: –Ω–µ—Ç –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö, –Ω–µ—Ç –∞–Ω–Ω–æ—Ç–∞—Ü–∏–π —Ç–∏–ø–æ–≤

---

## –°–∏–ª—å–Ω—ã–µ —Å—Ç–æ—Ä–æ–Ω—ã
- –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞, –≤—ã—Å–æ–∫–∞—è –º–æ–¥—É–ª—å–Ω–æ—Å—Ç—å
- –ß–µ—Ç–∫–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ —Å–ª–æ–µ–≤ (handlers, services, db)
- –ü—Ä–æ—Å—Ç–æ—Ç–∞ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è (–Ω–æ–≤—ã–µ —Å–µ—Ä–≤–∏—Å—ã, –∫–æ–º–∞–Ω–¥—ã)
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ ORM –∏ —Å–µ—Ä–≤–∏—Å–Ω–æ–≥–æ —Å–ª–æ—è
- –õ–µ–≥–∫–∏–π –∑–∞–ø—É—Å–∫ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ (Docker, .env)

---

## –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –∏ roadmap

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω—ã–µ –¥–æ—Ä–∞–±–æ—Ç–∫–∏
| –ó–∞–¥–∞—á–∞ | –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç | –°–ª–æ–∂–Ω–æ—Å—Ç—å |
|--------|-----------|-----------|
| –í–Ω–µ–¥—Ä–∏—Ç—å PostgreSQL –∏ Alembic | high | medium |
| –î–æ–±–∞–≤–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É –æ—à–∏–±–æ–∫ –∏ –≤–∞–ª–∏–¥–∞—Ü–∏—é | high | low/medium |
| –í–≤–µ—Å—Ç–∏ –∞–Ω–Ω–æ—Ç–∞—Ü–∏–∏ —Ç–∏–ø–æ–≤ –∏ docstrings | medium | low |
| –ü–æ–∫—Ä—ã—Ç—å —Ç–µ—Å—Ç–∞–º–∏ –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫—É | high | medium |
| –í–Ω–µ–¥—Ä–∏—Ç—å CI/CD (GitHub Actions) | medium | medium |
| –î–æ–±–∞–≤–∏—Ç—å –ª–∏–Ω—Ç–µ—Ä—ã (flake8, black) | medium | low |
| –£–ª—É—á—à–∏—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é | low | low |
| –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å graceful shutdown, retry | medium | medium |

### Roadmap
- **30 –¥–Ω–µ–π:**
  - –í–Ω–µ–¥—Ä–∏—Ç—å PostgreSQL, Alembic, –¥–æ–±–∞–≤–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏
  - –ü–æ–∫—Ä—ã—Ç—å —Ç–µ—Å—Ç–∞–º–∏ –æ—Å–Ω–æ–≤–Ω—ã–µ —Å–µ—Ä–≤–∏—Å—ã (timer, tasks, projects)
  - –í–≤–µ—Å—Ç–∏ –æ–±—Ä–∞–±–æ—Ç–∫—É –æ—à–∏–±–æ–∫ –∏ –±–∞–∑–æ–≤—É—é –≤–∞–ª–∏–¥–∞—Ü–∏—é
- **60 –¥–Ω–µ–π:**
  - –í–Ω–µ–¥—Ä–∏—Ç—å CI/CD, –ª–∏–Ω—Ç–µ—Ä—ã, pre-commit —Ö—É–∫–∏
  - –î–æ–±–∞–≤–∏—Ç—å –∞–Ω–Ω–æ—Ç–∞—Ü–∏–∏ —Ç–∏–ø–æ–≤, docstrings
  - –£–ª—É—á—à–∏—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é (–ø—Ä–∏–º–µ—Ä .env, —Å—Ö–µ–º—ã)
- **90 –¥–Ω–µ–π:**
  - –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å retry, graceful shutdown
  - –ü–µ—Ä–µ–≤–µ—Å—Ç–∏ –Ω–∞ DI-–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä (–Ω–∞–ø—Ä–∏–º–µ—Ä, dependency-injector)
  - –î–æ–±–∞–≤–∏—Ç—å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã, –ø–æ–∫—Ä—ã—Ç—å edge-cases

### –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—ã
- –í–º–µ—Å—Ç–æ SQLite –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å PostgreSQL (–±–æ–ª–µ–µ –Ω–∞–¥–µ–∂–Ω–æ –∏ –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ)
- –í–º–µ—Å—Ç–æ —Ä—É—á–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫ ‚Äî –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å middleware/logging
- –í–º–µ—Å—Ç–æ –º–æ–Ω–æ–ª–∏—Ç–∞ ‚Äî —Ä–∞—Å—Å–º–æ—Ç—Ä–µ—Ç—å –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å—ã –ø—Ä–∏ —Ä–æ—Å—Ç–µ –Ω–∞–≥—Ä—É–∑–∫–∏

---

## –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

1. –ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
2. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:
   ```bash
   pip install -r requirements.txt
   ```
3. –ó–∞–ø–æ–ª–Ω–∏—Ç–µ .env (BOT_TOKEN, DATABASE_URL)
4. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –±–æ—Ç–∞:
   ```bash
   python bot.py
   ```

## –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã
- `/start` ‚Äî –Ω–∞—á–∞—Ç—å Pomodoro
- `/pause` ‚Äî –ø–∞—É–∑–∞
- `/skipbreak` ‚Äî –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å –æ—Ç–¥—ã—Ö
- `/settings` ‚Äî –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
- `/newproject` ‚Äî —Å–æ–∑–¥–∞—Ç—å –ø—Ä–æ–µ–∫—Ç
- `/newtask` ‚Äî —Å–æ–∑–¥–∞—Ç—å –∑–∞–¥–∞—á—É
- `/focus` ‚Äî –≤—ã–±—Ä–∞—Ç—å –∑–∞–¥–∞—á—É
- `/done` ‚Äî –∑–∞–≤–µ—Ä—à–∏—Ç—å –∑–∞–¥–∞—á—É
- `/tasks` ‚Äî —Å–ø–∏—Å–æ–∫ –∑–∞–¥–∞—á
- `/projects` ‚Äî —Å–ø–∏—Å–æ–∫ –ø—Ä–æ–µ–∫—Ç–æ–≤
- `/forest` ‚Äî –≤–∞—à –ª–µ—Å
- `/stats` ‚Äî —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
- `/creategroup` ‚Äî —Å–æ–∑–¥–∞—Ç—å –≥—Ä—É–ø–ø—É
- `/joingroup` ‚Äî –≤—Å—Ç—É–ø–∏—Ç—å –≤ –≥—Ä—É–ø–ø—É
- `/groupstats` ‚Äî —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –≥—Ä—É–ø–ø—ã
- `/leaderboard` ‚Äî —Ç–æ–ø-10
- `/plan` ‚Äî –∑–∞–¥–∞—á–∏ –Ω–∞ –¥–µ–Ω—å
- `/dailyreminder` ‚Äî –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ
- `/theme` ‚Äî —Å–º–µ–Ω–∞ —Ç–µ–º—ã
- `/guide` ‚Äî –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π –≥–∞–π–¥

## –¢–µ—Å—Ç—ã
- –Æ–Ω–∏—Ç-—Ç–µ—Å—Ç—ã: `pytest handlers/tests/`

## –õ–∏—Ü–µ–Ω–∑–∏—è
MIT
